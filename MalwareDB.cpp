//---------------------------------------------------------------------------

#include <vcl.h>
#include <FireDAC.DApt.hpp>
#pragma hdrstop

#include "MalwareDB.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TMalwareBrowser *MalwareBrowser;
//---------------------------------------------------------------------------
__fastcall TMalwareBrowser::TMalwareBrowser(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------





void __fastcall TMalwareBrowser::BrowseButtonClick(TObject *Sender)
{
	 FDConnection1->DriverName = "SQLite";
	 FDConnection1->Params->Values["Database"] =  "C:\\Users\\Hugh\\Databases\\malwaredatabase.db";
	try
	{
		FDConnection1->Open();
		TFDQuery *query;
		query = new TFDQuery(this);
		query->Connection = FDConnection1;
		query->SQL->Text = "SELECT * FROM ADWARE";
		query->Open();
		TVarRec args[1] = {"SR_Num"};
		while (!query->Eof) {
		  TVarRec arguments[1] = { query->FieldByName("Family")->AsString};
		  DBDisplay->Items->Add(System::UnicodeString::Format("|%25s |",arguments, ARRAYSIZE(arguments) - 1));
		  query->Next();
		}
		query->Close();
		FDConnection1->Close();

	}
	catch (Exception &E)
	{
		String Errormsg = E.Message;
        DBDisplay->Items->Add(Errormsg);
	}
}


//---------------------------------------------------------------------------


